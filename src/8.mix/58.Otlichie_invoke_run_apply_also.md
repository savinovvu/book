Разберём различия между функциями `invoke`, `run`, `apply` и `also` в Kotlin. Эти функции часто используются для работы с объектами в более читаемом и компактном стиле.

---

### 1. **invoke**
- **Назначение**: Позволяет вызвать объект как функцию, если в его классе объявлен оператор `invoke`.
- **Контекст**: Не является функцией-расширением, но работает через перегрузку оператора.
- **Возвращаемое значение**: Любой тип (зависит от реализации `invoke`).
- **Пример**:
  ```kotlin
  class Multiplier(val factor: Int) {
      operator fun invoke(number: Int): Int = number * factor
  }

  val multiplyByTwo = Multiplier(2)
  println(multiplyByTwo(5)) // Вызов invoke(5) -> 10
  ```

---

### 2. **run**
- **Назначение**: Выполнение блока кода с объектом в качестве контекста и возврат результата блока.
- **Контекст**: `this` (можно опустить).
- **Возвращаемое значение**: Результат последнего выражения в блоке.
- **Пример**:
  ```kotlin
  val result = "Hello".run {
      println(length) // 5 (доступ через this.length)
      length + 10     // Возвращает 15
  }
  println(result) // 15
  ```
- **Вариант без контекста**: `run { ... }` для выполнения блока кода без привязки к объекту.

---

### 3. **apply**
- **Назначение**: Инициализация или настройка объекта. Работает с самим объектом как контекстом.
- **Контекст**: `this` (можно опустить).
- **Возвращаемое значение**: Сам объект (`this`).
- **Пример**:
  ```kotlin
  val person = Person().apply {
      name = "Alice" // this.name = "Alice"
      age = 30       // this.age = 30
  } // Возвращает объект Person
  ```

---

### 4. **also**
- **Назначение**: Выполнение побочных действий (например, логирование) без изменения объекта.
- **Контекст**: `it` (имя можно изменить).
- **Возвращаемое значение**: Сам объект (`it`).
- **Пример**:
  ```kotlin
  val list = mutableListOf(1, 2, 3).also {
      it.add(4) // Добавляет элемент
      println("Список: $it") // Побочное действие
  } // Возвращает список [1, 2, 3, 4]
  ```

---

### Сравнение в таблице
| Функция  | Контекст (`this`/`it`) | Возвращает       | Использование                           |
|----------|------------------------|------------------|-----------------------------------------|
| `invoke` | -                      | Любой тип        | Вызов объекта как функции              |
| `run`    | `this`                 | Результат блока  | Вычисления с контекстом                |
| `apply`  | `this`                 | Сам объект       | Настройка объекта                      |
| `also`   | `it`                   | Сам объект       | Побочные действия с объектом           |

---

### Когда что использовать?
- **`invoke`** — когда нужно сделать объект вызываемым (например, кастомные операции или callback).
- **`run`** — для вычислений, где требуется доступ к контексту объекта, и нужно вернуть результат.
- **`apply`** — для инициализации объектов (часто с `this`).
- **`also`** — для логирования, проверок или других действий, не меняющих объект.

Пример цепочки:
```kotlin
val user = User().apply { 
    name = "Tom"
}.also { 
    println("Создан пользователь: $it") 
}.run {
    "Имя: $name" // Преобразует объект в строку
}
```