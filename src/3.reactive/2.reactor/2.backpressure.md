**Backpressure (обратное давление)** — это механизм управления потоком данных в реактивных системах, когда **потребитель (subscriber)** не успевает обрабатывать данные, поступающие от **источника (publisher)**. Если не контролировать этот процесс, может возникнуть перегрузка системы, например, исчерпание памяти или ресурсов. В Reactor (библиотека для Java/Kotlin) backpressure реализован через **Reactive Streams**, где подписчик явно запрашивает данные с помощью `Subscription.request(n)`.

### Обработка Backpressure в Reactor
Reactor предоставляет стратегии для обработки backpressure, которые применяются через операторы. Вот основные из них:

---

### 1. **onBackpressureBuffer**
Буферизует элементы, если потребитель не успевает их обработать.
- **Особенности**:
    - Элементы сохраняются во внутреннем буфере (по умолчанию — неограниченном).
    - При переполнении буфера (если задан лимит) может выбрасывать ошибку `OverflowException`.
- **Варианты**:
    - `onBackpressureBuffer()` — неограниченный буфер (риск OOM).
    - `onBackpressureBuffer(int maxSize)` — буфер с лимитом.
    - `onBackpressureBuffer(int maxSize, BufferOverflowStrategy strategy)` — стратегия при переполнении (например, `DROP_LATEST`).

**Пример**:
```java
Flux.range(1, 1000)
    .onBackpressureBuffer(10, BufferOverflowStrategy.DROP_OLDEST)
    .subscribe(...);
```

---

### 2. **onBackpressureDrop**
Отбрасывает элементы, которые не могут быть обработаны из-за отсутствия запросов от подписчика.
- **Особенности**:
    - Подходит для сценариев, где можно пропускать данные (например, сенсорные показания).
    - Можно добавить callback для обработки отброшенных элементов.
- **Пример**:
```java
Flux.range(1, 1000)
    .onBackpressureDrop(dropped -> System.out.println("Dropped: " + dropped))
    .subscribe(...);
```

---

### 3. **onBackpressureLatest**
Сохраняет только **последний** элемент, отбрасывая предыдущие непрочитанные данные.
- **Особенности**:
    - Полезно, когда важен только актуальный элемент (например, обновления UI).
    - Похож на `onBackpressureBuffer(1, DROP_OLDEST)`.
- **Пример**:
```java
Flux.range(1, 1000)
    .onBackpressureLatest()
    .subscribe(...);
```

---

### 4. **onBackpressureError**
Немедленно генерирует ошибку `IllegalStateException`, если источник emits данные быстрее, чем подписчик их запрашивает.
- **Пример**:
```java
Flux.range(1, 1000)
    .onBackpressureError()
    .subscribe(...);
```

---

### 5. **Лимитирование запросов (LimitRate)**
Используется, когда подписчик управляет скоростью через `Subscription.request(n)`. Reactor автоматически разбивает запросы на небольшие партии.
- **Пример**:
```java
Flux.range(1, 1000)
    .limitRate(10) // Запрашивает по 10 элементов за раз
    .subscribe(...);
```

---

### Когда какую стратегию использовать?
- **onBackpressureBuffer**: Если данные критичны, и можно временно хранить их в памяти.
- **onBackpressureDrop**: Если данные неважны (например, пропуск кадров видео).
- **onBackpressureLatest**: Если нужен только последний элемент (например, текущее состояние).
- **onBackpressureError**: Если перегрузка недопустима и требуется немедленное прерывание.
- **LimitRate**: Для контроля скорости вручную через подписку.

### Важно!
Некоторые источники (например, `Flux.interval`) не поддерживают backpressure по умолчанию. В таких случаях требуется явно применять стратегии.